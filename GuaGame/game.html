<html>
  <head>
    <meta charset="utf-8">
    <title>game 1</title>
    <style media="screen">
      canvas{
        border: 1px black solid;
      }
    </style>
  </head>
  <body>
      <canvas id="id-canvas" width="600" height="500"></canvas>

<script>
var log = console.log.bind(console)

var imageFromPath = function(path){
    var img = new Image()
    img.src = path
    return img
}

var Paddle = function(){
  var image = imageFromPath('paddle.png')
  var o = {
    image: image,
    x: 100,
    y: 200,
    speed: 5,
  }
  var paddle = o
  o.moveLeft = function(){
    //这里paddle应该为o的
    paddle.x -= paddle.speed
  }

  o.moveRight = function(){
    paddle.x += paddle.speed
  }
  return o
}

var GuaGame = function(){
  var g = {}
  var canvas = document.querySelector("#id-canvas")
  var context = canvas.getContext('2d')
  g.canvas = canvas
  g.context = context
  setInterval(function(){
    //update
    //draw
    g.update()
    //clear
    context.clearRect(0, 0, canvas.width, canvas.height)
    g.draw()
  }, 1000/30)
  return g
}


var __main = function(){
  var game = new GuaGame()
  var paddle = new Paddle()


  var leftDown = false
  var rigntDown = false

  window.addEventListener('keydown', function(event){
    log('keydown')
    var k = event.key
    if (k == 'a') {
      leftDown = true
    }else if (k == 'd') {
      rigntDown = true
    }
  })
  //键松开的时候
  window.addEventListener('keyup', function(event){
    log('keyup')
    var k = event.key
    if (k == 'a') {
      leftDown = false
    }else if (k == 'd') {
      rigntDown = false
    }
  })
  game.update = function(){
    //update x and y
    // draw
    if (leftDown) {

      paddle.moveLeft()
    }else if(rigntDown){

      paddle.moveRight()
    }
  }
  game.draw = function(){
    game.context.drawImage(paddle.image, paddle.x, paddle.y)
  }
}
__main()

</script>
  </body>

</html>
